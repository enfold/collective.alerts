{"version":3,"file":"chunks/100.39f3d1927c492f4c61f9.min.js","mappings":"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","sources":["webpack://collective.alerts/./resources/js/jsalerts.pattern.js","webpack://collective.alerts/./resources/jsalerts-config.js"],"sourcesContent":["import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport MD5 from \"crypto-js/md5\";\nimport \"jquery.cookie\";\nimport(\"./jsalerts.scss\");\n\n\nexport default Base.extend({\n    // The name for this pattern\n    name: 'alertmessage',\n    trigger: '.pat-alertmessage',\n    parser: 'mockup',\n    defaults: {\n        'get_message_view': '/get-alert-message',\n        'show_in_context': true,\n        'cache': false\n    },\n\n    set_cookie: function(data){\n      var self = this;\n      var cookie_expire = data.cookie_expire ? data.cookie_expire : 0;\n\n      if (cookie_expire === 0 || isNaN(parseFloat(cookie_expire))){\n        return;\n      }\n      var md5_key = data.alert_location + data.title + data.cookie_expire + data.display_on_every_page + data.klass + data.message + data.retract_timeout + data.date;\n\n      var val = MD5(md5_key);\n      var date = new Date();\n      date.setTime(date.getTime() + (cookie_expire * 60 * 60 * 1000));\n      $.cookie(\"alert.message.\"+val.toString().slice(20), \"1\", { expires: date, path: '/' });\n    },\n\n    is_visible: function(data){\n      var self = this;\n      var should_show = false;\n      if (data.visible){\n        // Emergency message visible, now check cookie\n        var md5_key = data.alert_location + data.title + data.cookie_expire + data.display_on_every_page + data.klass + data.message + data.retract_timeout + data.date;\n        var val = MD5(md5_key);\n        var cookie = $.cookie(\"alert.message.\"+val.toString().slice(20));\n\n        if (cookie === undefined){\n          // No cookie, now check if should be seen at homepage only\n          var display_on_every_page;\n          if (data.display_on_every_page === undefined){\n            // By default show on every page, unless explicitly denied\n            display_on_every_page = true;\n          }\n          else{\n            display_on_every_page = data.display_on_every_page;\n          }\n\n          if (display_on_every_page){\n            // This message should be displayed everywhere\n            should_show = true;\n          }\n          else{\n            should_show = self.options.show_in_context;\n          }\n\n        }\n        // Cookie was present, so we are not going to show the message\n      }\n\n      return should_show;\n    },\n\n    show_on_top: function(data){\n        var self = this;\n        var div = $('<div class=\"alert alert-'+data.klass+' alert-dismissible\" role=\"alert\"></div>');\n        var close = $('<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>')\n                    .on('click', function () {\n                        self.$el.html(\"\");\n                        self.set_cookie(data);\n                    });;\n\n        var msg = $('<div></div>');\n        if (data.title !== \"\"){\n          msg.append($('<strong>'+data.title+': </strong>'));\n        }\n        if (data.message !== \"\"){\n          msg.append($('<span>'+data.message+'</span>'));\n        }\n        div.append(close);\n        div.append(msg);\n\n        self.$el.html(\"\");\n        self.$el.append(div);\n\n        if (data.retract_timeout !== 0){\n            setTimeout(function() {\n                div.remove();\n            }, data.retract_timeout * 1000);\n        }\n    },\n\n    show_slide: function(data, direction){\n      var self = this;\n      var slide_box = $('<div class=\"slide-alert-message\"></div>');\n      slide_box.addClass(direction);\n      slide_box.addClass('alert-'+data.klass);\n\n      var minimize = $('<button type=\"button\" class=\"close minimize\"><span aria-hidden=\"true\">&nbsp;-</span></button>')\n                  .on('click', function () {\n                      if (slide_box.hasClass('visible')){\n                        slide_box.removeClass('visible');\n                        clearTimeout(timeout);\n                      }\n                  });\n\n      var close = $('<button type=\"button\" class=\"close\"><span aria-hidden=\"true\">&times;</span></button>')\n                  .on('click', function () {\n                      self.$el.html(\"\");\n                      self.set_cookie(data);\n                  });\n\n      var msg = $('<div></div>');\n      if (data.message !== \"\"){\n        msg.append($('<span>'+data.message+'</span>'));\n      }\n      slide_box.append(close);\n      slide_box.append(minimize);\n      slide_box.append(msg);\n\n      self.$el.html(\"\");\n      self.$el.append(slide_box);\n\n      var timeout;\n      /* Trigger button to slide the notification open */\n      var trigger_tab = $('<span class=\"btn open-slide-alert-message\"></button>')\n                        .on('click', function () {\n                          if (slide_box.hasClass('visible')){\n                            slide_box.removeClass('visible');\n                            clearTimeout(timeout);\n                          }\n                          else{\n                            slide_box.addClass('visible');\n                            if (data.retract_timeout !== 0){\n                                timeout = setTimeout(function() {\n                                    slide_box.removeClass('visible');\n                                }, data.retract_timeout * 1000);\n                            }\n                          }\n                        });\n\n      trigger_tab.addClass(direction);\n      trigger_tab.addClass('alert-'+data.klass);\n      trigger_tab.html(data.title ? data.title : data.klass);\n      self.$el.append(trigger_tab);\n\n      /* It should be opened by default */\n      trigger_tab.trigger('click');\n\n    },\n\n    show_mobile: function(data){\n      var self = this;\n      var alert_box = $('<div class=\"slide-alert-message\"></div>');\n      alert_box.addClass('alert-'+data.klass);\n\n      var close = $('<button type=\"button\" class=\"close\"><span aria-hidden=\"true\">&times;</span></button>')\n                  .on('click', function () {\n                      self.$el.html(\"\");\n                      self.set_cookie(data);\n                  });\n\n      var msg = $('<div></div>');\n      if (data.title !== \"\"){\n        msg.append($('<strong>'+data.title+': </strong>'));\n      }\n      if (data.message !== \"\"){\n        msg.append($('<span>'+data.message+'</span>'));\n      }\n      alert_box.append(close);\n      alert_box.append(msg);\n\n      self.$el.html(\"\");\n      self.$el.append(alert_box);\n    },\n\n    init: function() {\n      if (window.location.pathname.includes(\"@@set-alert-message\")){\n          return;\n      }\n      var self = this;\n      $.ajax({\n        url:      self.options.get_message_view,\n        type:     'GET',\n        context:  self.$el,\n        async:    true,\n        cache:    self.options.cache\n      }).done(function(data, status, xhr) {\n        if (!self.is_visible(data)){\n          return;\n        }\n        if(window.innerWidth <= 769) {\n            self.show_mobile(data);\n        }\n        else{\n            if (data.alert_location === 'fixed_top'){\n              self.show_on_top(data);\n            }\n\n            if (data.alert_location === 'slide_left'){\n              self.show_slide(data, 'left');\n            }\n\n            if (data.alert_location === 'slide_right'){\n              self.show_slide(data, 'right');\n            }\n        }\n      });\n    }\n  });\n","import registry from \"@patternslib/patternslib/src/core/registry\";\nimport \"./js/jsalerts.pattern\";\n\nregistry.init();\n"],"names":["Base","name","trigger","parser","defaults","set_cookie","data","cookie_expire","isNaN","parseFloat","md5_key","alert_location","title","display_on_every_page","klass","message","retract_timeout","date","val","MD5","Date","setTime","getTime","$","toString","slice","expires","path","is_visible","should_show","visible","undefined","this","options","show_in_context","show_on_top","self","div","close","on","$el","html","msg","append","setTimeout","remove","show_slide","direction","slide_box","addClass","timeout","minimize","hasClass","removeClass","clearTimeout","trigger_tab","show_mobile","alert_box","init","window","location","pathname","includes","url","get_message_view","type","context","async","cache","done","status","xhr","innerWidth","registry"],"sourceRoot":""}