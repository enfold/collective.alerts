{"version":3,"file":"chunks/100.776cf494544a80975f65.min.js","mappings":"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","sources":["webpack://collective.alerts/./resources/js/jsalerts.pattern.js","webpack://collective.alerts/./resources/jsalerts-config.js"],"sourcesContent":["import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport MD5 from \"crypto-js/md5\";\nimport \"jquery.cookie\";\nimport(\"./jsalerts.scss\");\n\n\nexport default Base.extend({\n    // The name for this pattern\n    name: 'alertmessage',\n    trigger: '.pat-alertmessage',\n    parser: 'mockup',\n    defaults: {\n        'get_message_view': '/get-alert-message',\n        'show_in_context': true,\n        'cache': false\n    },\n\n    set_cookie: function(data, action){\n      var self = this;\n      var cookie_expire = data.cookie_expire ? data.cookie_expire : 0;\n      var cookie_expire_minimize = data.cookie_expire_minimize ? data.cookie_expire_minimize : 0;\n\n      if (action === 'minimize' && (cookie_expire_minimize === 0 || isNaN(parseFloat(cookie_expire_minimize)))){\n        return;\n      }\n      if (action === 'close' && (cookie_expire === 0 || isNaN(parseFloat(cookie_expire)))){\n        return;\n      }\n\n      var md5_key = data.alert_location + data.title + data.cookie_expire + data.cookie_expire_minimize + data.display_on_every_page + data.klass + data.message + data.retract_timeout + data.date;\n\n      var val = MD5(md5_key);\n      var date = new Date();\n      if (action == 'close'){\n        date.setTime(date.getTime() + (cookie_expire * 60 * 60 * 1000));\n      }\n      if (action == 'minimize'){\n        date.setTime(date.getTime() + (cookie_expire_minimize * 60 * 60 * 1000));\n      }\n\n      $.cookie(\"alert.message.\"+action+\".\"+val.toString().slice(20), \"1\", { expires: date, path: '/' });\n    },\n\n    is_visible: function(data){\n      var self = this;\n      var should_show = false;\n      if (data.visible){\n        // Emergency message visible, now check cookie\n        var md5_key = data.alert_location + data.title + data.cookie_expire + data.cookie_expire_minimize + data.display_on_every_page + data.klass + data.message + data.retract_timeout + data.date;\n        var val = MD5(md5_key);\n        var close_cookie = $.cookie(\"alert.message.close.\"+val.toString().slice(20));\n\n        if (close_cookie === undefined){\n          // No cookie, now check if should be seen at homepage only\n          var display_on_every_page;\n          if (data.display_on_every_page === undefined){\n            // By default show on every page, unless explicitly denied\n            display_on_every_page = true;\n          }\n          else{\n            display_on_every_page = data.display_on_every_page;\n          }\n\n          if (display_on_every_page){\n            // This message should be displayed everywhere\n            should_show = true;\n          }\n          else{\n            should_show = self.options.show_in_context;\n          }\n\n        }\n        // Cookie was present, so we are not going to show the message\n      }\n\n      return should_show;\n    },\n\n    show_on_top: function(data){\n        var self = this;\n        var div = $('<div class=\"alert alert-'+data.klass+' alert-dismissible\" role=\"alert\"></div>');\n\n        if(window.innerWidth <= 769) {\n          div.addClass(\"mobile\");\n        }\n\n        var close = $('<button type=\"button\" alt=\"close\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>')\n                    .on('click', function () {\n                        self.$el.html(\"\");\n                        self.set_cookie(data, 'close');\n                    });;\n\n        var msg = $('<div></div>');\n        if (data.title !== \"\"){\n          msg.append($('<strong>'+data.title+': </strong>'));\n        }\n        if (data.message !== \"\"){\n          msg.append($('<span>'+data.message+'</span>'));\n        }\n        div.append(close);\n        div.append(msg);\n\n        self.$el.html(\"\");\n        self.$el.append(div);\n\n        if (data.retract_timeout !== 0){\n            setTimeout(function() {\n                div.remove();\n            }, data.retract_timeout * 1000);\n        }\n    },\n\n    show_slide: function(data, direction){\n      var self = this;\n\n      var slide_box = $('<div class=\"slide-alert-message\"></div>');\n      slide_box.addClass(direction);\n      slide_box.addClass('alert-'+data.klass);\n\n      if(window.innerWidth <= 769) {\n        slide_box.addClass(\"mobile\");\n      }\n\n      var minimize = $('<button type=\"button\" alt=\"minimize\" class=\"close minimize\"><span aria-hidden=\"true\">&nbsp;-</span></button>')\n                  .on('click', function () {\n                      self.set_cookie(data, 'minimize');\n                      if (slide_box.hasClass('visible')){\n                        slide_box.removeClass('visible');\n                        clearTimeout(timeout);\n                      }\n                  });\n\n      var close = $('<button type=\"button\" alt=\"close\" class=\"close\"><span aria-hidden=\"true\">&times;</span></button>')\n                  .on('click', function () {\n                      self.$el.html(\"\");\n                      self.set_cookie(data, 'close');\n                  });\n\n      var msg = $('<div></div>');\n      if (data.message !== \"\"){\n        msg.append($('<span>'+data.message+'</span>'));\n      }\n      slide_box.append(close);\n      slide_box.append(minimize);\n      slide_box.append(msg);\n\n      self.$el.html(\"\");\n      self.$el.append(slide_box);\n\n      var timeout;\n      /* Trigger button to slide the notification open */\n      var trigger_tab = $('<span class=\"btn open-slide-alert-message\" alt=\"open\"></button>')\n                        .on('click', function () {\n                          if (slide_box.hasClass('visible')){\n                            slide_box.removeClass('visible');\n                            clearTimeout(timeout);\n                          }\n                          else{\n                            slide_box.addClass('visible');\n                            if (data.retract_timeout !== 0){\n                                timeout = setTimeout(function() {\n                                    slide_box.removeClass('visible');\n                                }, data.retract_timeout * 1000);\n                            }\n                          }\n                        });\n\n      trigger_tab.addClass(direction);\n      trigger_tab.addClass('alert-'+data.klass);\n      trigger_tab.html(data.title ? data.title : data.klass);\n      self.$el.append(trigger_tab);\n\n      var md5_key = data.alert_location + data.title + data.cookie_expire + data.cookie_expire_minimize + data.display_on_every_page + data.klass + data.message + data.retract_timeout + data.date;\n      var val = MD5(md5_key);\n      var minimize_cookie = $.cookie(\"alert.message.minimize.\"+val.toString().slice(20));\n      if (minimize_cookie === undefined){\n        /* Only open the notification if there is no cookie */\n        trigger_tab.trigger('click');\n      }\n\n    },\n\n    init: function() {\n      if (window.location.pathname.includes(\"@@set-alert-message\")){\n          return;\n      }\n      var self = this;\n      $.ajax({\n        url:      self.options.get_message_view,\n        type:     'GET',\n        context:  self.$el,\n        async:    true,\n        cache:    self.options.cache\n      }).done(function(data, status, xhr) {\n        if (!self.is_visible(data)){\n          return;\n        }\n        if (data.alert_location === 'fixed_top'){\n          self.show_on_top(data);\n        } else if (data.alert_location === 'slide_left'){\n          self.show_slide(data, 'left');\n        } else if (data.alert_location === 'slide_right'){\n          self.show_slide(data, 'right');\n        } else if (data.alert_location === 'slide_top'){\n          self.show_slide(data, 'top');\n        }\n      });\n    }\n  });\n","import registry from \"@patternslib/patternslib/src/core/registry\";\nimport \"./js/jsalerts.pattern\";\n\nregistry.init();\n"],"names":["Base","name","trigger","parser","defaults","set_cookie","data","action","cookie_expire","cookie_expire_minimize","isNaN","parseFloat","md5_key","alert_location","title","display_on_every_page","klass","message","retract_timeout","date","val","MD5","Date","setTime","getTime","$","toString","slice","expires","path","is_visible","should_show","visible","undefined","this","options","show_in_context","show_on_top","self","div","window","innerWidth","addClass","close","on","$el","html","msg","append","setTimeout","remove","show_slide","direction","slide_box","timeout","minimize","hasClass","removeClass","clearTimeout","trigger_tab","init","location","pathname","includes","url","get_message_view","type","context","async","cache","done","status","xhr","registry"],"sourceRoot":""}